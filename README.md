
# Kitchen Dispatch Simulation

This project simulates the fulfillment of delivery orders for a kitchen using two different courier dispatch strategies. The system receives delivery orders, prepares them, and dispatches couriers to pick them up. The project evaluates the performance of two dispatch strategies: Matched and First-in-First-out (FIFO).

## Table of Contents
- [Requirements](#requirements)
- [Design Decisions](#design-decisions)
- [Core Logic](#core-logic)
- [Setup and Running the System](#setup-and-running-the-system)
- [Configuration](#configuration)
- [Project Structure](#project-structure)

## Requirements

To run this project, you need:
- Python 3.8 or higher
- Dependencies listed in `requirements.txt`

## Design Decisions

1. **Object-Oriented Design**: The system is designed using classes to represent couriers, orders, and the kitchen. This modular approach makes the system easy to maintain and extend.
2. **Design Pattern Usage**: The system uses Startegy Design Pattern for dispatching couriers
   **Dispatch Strategies**: Two dispatch strategies are implemented:
   - **Matched**: A courier is dispatched for a specific order and can only pick up that order.
   - **FIFO**: A courier picks up the next available order upon arrival.
3. **Concurrency**: The system uses threading to simulate the real-time preparation of orders and the arrival of couriers.
4. **Logging**: The system logs events such as order reception, preparation, courier dispatch, and pickup. This provides visibility into the system's operation.
5. **Unit Tests**: Comprehensive unit tests are included to ensure the correctness of the system. The tests cover initialization, dispatch strategies, order handling, and the simulation process.

## Core Logic

### `kitchen,py`
This `Kitchen` class, which is responsible for managing the preparation and dispatch of orders. It uses a queue to manage incoming orders and couriers. The `Kitchen` class handles the reception of orders, preparation of orders, arrival of couriers, and the pickup of orders by couriers. It ensures thread safety using locks and calculates the food and courier wait times for performance evaluation.

### `simulation.py`
This is the main entry point for running the kitchen dispatch simulation. It sets up logging, loads order data, initializes the kitchen with the specified dispatch strategy, and starts the simulation by generating orders and dispatching couriers. The simulation runs multiple threads to handle order preparation and courier dispatch concurrently. It also logs the final statistics of the simulation, such as average food and courier wait times, before exiting.

## Setup and Running the System

1. **Copy the folder**
   ```sh
   cd dispatchorders
   ```

2. **Install python and Dependencies**
   ```sh
   pip install -r requirements.txt
   ```

3. **Run the Simulation**
   The simulation can be run using the following command:
   ```sh
   python simulation.py <strategy>
   ```
   where `<strategy>` can be either `matched` or `fifo`. For example:
   ```sh
   python simulation.py matched
   ```
   ```sh
   ```

4. **View Logs**
   Logs are saved in the `logs` directory with a timestamp. You can view the log file to see the detailed operations and statistics.

5. **Run the Unit Tests**
   To run the unit tests, use the following command:
   ```sh
   python -m unittest test/test.py
   ```

## Configuration

- **Order Data**: The order data is loaded from `dispatch_orders.json`. You can modify this file to add or change the orders.
- **Dispatch Strategy**: The dispatch strategy is specified as a command-line argument when running the simulation (`matched` or `fifo`).
- **Logging**: The logging configuration can be adjusted in `simulation.py` within the `setup_logging` function.

## Project Structure

```
.
├── classes
│   ├── courier.py
│   ├── kitchen.py
│   ├── order.py
│   ├── strategy.py
├── logs
│   ├── kitchen_simulation_<timestamp>.log
├── test
│   ├── test.py
├── dispatch_orders.json
├── requirements.txt
├── simulation.py
├── README.md
```

- **classes**: Contains the class definitions for Courier, Kitchen, Order, and the dispatch strategies.
- **logs**: Contains the log files generated by the simulation.
- **test**: Contains unit tests for the project.
- **dispatch_orders.json**: JSON file containing the order data.
- **simulation.py**: The main simulation script.
- **requirements.txt**: Lists the Python dependencies.

## Example Log Output
Here is an example of the log output that you can expect:

```
2024-06-20 22:00:49 - INFO - Order received: 1 - Pizza, Prep Time: 5s
2024-06-20 22:00:54 - INFO - Order prepared: 1 - Pizza
2024-06-20 22:00:54 - INFO - Courier dispatched: 1 for Order: 1
2024-06-20 22:00:58 - INFO - Courier arrived: 1 for Order: 1
2024-06-20 22:00:58 - INFO - Order picked up: 1 by Courier: 1
2024-06-20 22:00:58 - INFO - Food wait time: 4000 ms
2024-06-20 22:00:58 - INFO - Courier wait time: 0 ms
```

This output shows the sequence of events for order preparation and courier dispatch, along with the wait times.
